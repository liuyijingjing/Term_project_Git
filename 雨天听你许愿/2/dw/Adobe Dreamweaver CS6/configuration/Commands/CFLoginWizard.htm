<!-- MENU-LOCATION=NONE -->
<!DOCTYPE HTML SYSTEM "-//Macromedia//DWExtension layout-engine 5.0//dialog">
<!---
* Copyright 2005 Macromedia, Inc. All rights reserved.
* DO NOT REDISTRIBUTE THIS SOFTWARE IN ANY WAY WITHOUT THE EXPRESSED
* WRITTEN PERMISSION OF MACROMEDIA.
--->
<html xmlns:MMString="http://www.macromedia.com/schemes/data/string/">
<head>
<title><MMString:loadString id="Commands/CFLoginWizard/title" /></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script language="javascript" src="../Shared/Common/Scripts/dwscripts.js"></script>
<script language="javascript" src="CFLoginWizard.js"></script>
<script language="JavaScript">
//--------------- LOCALIZEABLE GLOBALS---------------
var AppName_select_path_in_site = dw.loadString('Commands/CFLoginWizard/AppName_select_path_in_site');
var Succes_page_Invalid_message = dw.loadString('Commands/CFLoginWizard/Succes_page_Invalid_message');
var Failure_page_Invalid_message = dw.loadString('Commands/CFLoginWizard/Failure_page_Invalid_message');
var Ldap_server_argsmissing_message =dw.loadString('Commands/CFLoginWizard/Ldap_server_argsmissing_message');
var Ldap_server_incorrect_message = dw.loadString('Commands/CFLoginWizard/Ldap_server_incorrect_message');
var NeedToMakeApplicationCFCEditable = dw.loadString('Commands/CFLoginWizard/NeedToMakeApplicationCFCEditable');
var noDWsite_message = dw.loadString('Commands/CFLoginWizard/noDWsite_message');
var noFocus_message = dw.loadString('Commands/CFLoginWizard/noFocus_message');
var emptyDomain_message = dw.loadString('Commands/CFLoginWizard/emptyDomain_message');
var emptyUserPwd_message = dw.loadString('Commands/CFLoginWizard/emptyUserPwd_message');
var noSynch_message = dw.loadString('Commands/CFLoginWizard/noSynch_message');
var NotImplemented = dw.loadString('Commands/CFLoginWizard/NotImplemented');
var remoteSiteNotValid_message = dw.loadString('Commands/CFLoginWizard/remoteSiteNotValid_message');
var not200_message = dw.loadString('Commands/CFLoginWizard/not200_message');
var willNowclose_message = dw.loadString('Commands/CFLoginWizard/willNowclose_message');
var no_queryString_message = dw.loadString('Commands/CFLoginWizard/no_queryString_message');
var MSG_CHOOSEFOLDER = dw.loadString('Commands/CFLoginWizard/MSG_CHOOSEFOLDER');
var MSG_verificationSuccessful = dw.loadString('Commands/CFLoginWizard/MSG_verificationSuccessful');
var MSG_verificationFailed = dw.loadString('Commands/CFLoginWizard/MSG_verificationFailed');

//--------------- END LOCALIZEABLE   ---------------
var HELP_DOC = MM.HELP_CFLoginWizard_cmd;
</script>
<link href="../Styles/CFLoginWizard.css" rel="stylesheet" type="text/css" />
<style type="text/css">
p {
	margin-right: 8px; 
}
h1 {
	text-align:left;
	font-weight: normal;
	font-size: x-small;
	margin-bottom: 4px;
}
label.radioButton {
	display:block;
}
code {font-size: 8.5pt}
</style>
</head>
<body onLoad="initializeUI()">
<div id="AppName" class="mainWizardPanel" style="visibility:visible;">
	<form name="appname">
		<img src="BNR_ColdFusionLoginWizard.png" MMString:alt="Commands/CFLoginWizard/img/alt/Macromedia" width="642" height="73">
		<h1><MMString:loadString id="Commands/CFLoginWizard/text/Welcome" /></h1>
		<p> <MMString:loadString id="Commands/CFLoginWizard/text/This" /></p>
		<p><MMString:loadString id="Commands/CFLoginWizard/text/Please" /></p>
		<p>
			<input name="apppath" type="text"  size="50" ID="Text1">
			<input type="button" name="BrowseButton" MMString:value="Commands/CFLoginWizard/button/BrowseButton/Browse" onClick="browseFile('apppath');focus(this)">
		</p>
		<div id="AppNameButtons" class="mainWizardButtons">
			<div class="leftWizardButtons">
				<input type="submit" class="navButtonHelp" name="appname_help" MMString:value="Commands/CFLoginWizard/submit/appname_help/Help" onclick="dwscripts.displayDWHelp(HELP_DOC);" >
			</div>
			<div class="rightWizardButtons">
				<input type="submit" class="navButtonBack" name="appname_back" MMString:value="Commands/CFLoginWizard/submit/appname_back/Back" disabled>
				<input type="submit" class="navButtonNext" name="appname_next" MMString:value="Commands/CFLoginWizard/submit/appname_next/Next" onclick="GoToAuthType();" >
				<input type="submit" class="navButtonCancel" name="appname_cancel" MMString:value="Commands/CFLoginWizard/submit/appname_cancel/Cancel" onclick="window.close();" >
			</div>
		</div>
	</form>
</div>
<div id="AuthType" class="mainWizardPanel"> <img src="BNR_ColdFusionLoginWizard.png" MMString:alt="Commands/CFLoginWizard/img/alt/Macromedia" width="642" height="73">
	<h1><MMString:loadString id="Commands/CFLoginWizard/text/Authentication" /></h1>
	<form name="authtypeform">
		<table class="cls_CFLoginWizard_table" width="100%"  border="0" cellspacing="1">
			<tr>
				<td colspan="2" valign="baseline"><MMString:loadString id="Commands/CFLoginWizard/text/Select" /> </td>
			</tr>
			<tr>
				<td valign="baseline"><input name="authenticationtype" type="radio" value="Simple" checked ></td>
				<td width="100%" valign="baseline"><p style="margin-bottom:8px;"><MMString:loadString id="Commands/CFLoginWizard/text/Simple" /></p></td>
			</tr>
			<tr valign="baseline">
				<td><input name="authenticationtype" type="radio" value="NT" ></td>
				<td><p style="margin-bottom:8px;"><MMString:loadString id="Commands/CFLoginWizard/text/Windows" /></p></td>
			</tr>
			<tr valign="baseline">
				<td><input name="authenticationtype" type="radio" value="LDAP" ></td>
				<td><p style="margin-bottom:8px;"><MMString:loadString id="Commands/CFLoginWizard/text/LDAP" /></p></td>
			</tr>
		</table>
		<br>
		<table width="100%"  border="0" class="cls_CFLoginWizard_table_1" cellspacing="1">
			<tr valign="baseline">
				<td colspan="2"><MMString:loadString id="Commands/CFLoginWizard/text/Select_1" /> </td>
			</tr>
			<tr valign="baseline">
				<td><input type="radio" name="basicAuthlogin" value="CFlogin" checked></td>
				<td width="100%"><MMString:loadString id="Commands/CFLoginWizard/text/Use" /></td>
			</tr>
			<tr>
				<td><input type="radio" name="basicAuthlogin"  value="challenge"></td>
				<td valign="baseline"><MMString:loadString id="Commands/CFLoginWizard/text/Use_1" /></td>
			</tr>
		</table>
		<div id="AuthTypeButtons" class="mainWizardButtons">
			<div class="leftWizardButtons">
				<input type="submit" class="navButtonHelp" name="authtypeform_help" MMString:value="Commands/CFLoginWizard/submit/appname_help/Help" onclick="dwscripts.displayDWHelp(HELP_DOC);" >
			</div>
			<div class="rightWizardButtons">
				<input type="submit" class="navButtonBack" name="authtypeform_back" MMString:value="Commands/CFLoginWizard/submit/appname_back/Back" onclick="BeginWizard();">
				<input type="submit" class="navButtonNext" name="authtypeform_next" MMString:value="Commands/CFLoginWizard/submit/appname_next/Next" onClick="selectAuthType();" >
				<input type="submit" class="navButtonCancel" name="authtypeform_cancel" MMString:value="Commands/CFLoginWizard/submit/appname_cancel/Cancel" onclick="window.close();" >
			</div>
		</div>
	</form>
</div>
<div id="NTAuth" class="mainWizardPanel">
	<form name="NTauth">
		<img src="BNR_ColdFusionLoginWizard.png" MMString:alt="Commands/CFLoginWizard/img/alt/Macromedia" width="642" height="73">
		<h1><MMString:loadString id="Commands/CFLoginWizard/text/Windows_1" /></h1>
		<p><MMString:loadString id="Commands/CFLoginWizard/text/Enter" /></p>
		<p>
			<input name="domainname" type="Text" size="30" class="cls_CFLoginWizard_input_domainname">
		</p>
		<div id="NTAuthButtons" class="mainWizardButtons">
			<div class="leftWizardButtons">
				<input type="submit" class="navButtonHelp" name="NTauth_help" MMString:value="Commands/CFLoginWizard/submit/appname_help/Help" onclick="dwscripts.displayDWHelp(HELP_DOC);" >
			</div>
			<div class="rightWizardButtons">
				<input type="submit" class="navButtonBack" name="NTauth_back" MMString:value="Commands/CFLoginWizard/submit/appname_back/Back" onclick="displayAuthType();">
				<input type="submit" class="navButtonNext" name="NTauth_next" MMString:value="Commands/CFLoginWizard/submit/appname_next/Next" onclick="callCodeGen('NT');">
				<input type="submit" class="navButtonCancel" name="NTauth_cancel" MMString:value="Commands/CFLoginWizard/submit/appname_cancel/Cancel" onclick="window.close();" >
			</div>
		</div>
	</form>
</div>
<div id="LDAPAuth" class="mainWizardPanel">
	<form name="LDAPauth">
		<img src="BNR_ColdFusionLoginWizard.png" MMString:alt="Commands/CFLoginWizard/img/alt/Macromedia" width="642" height="73">
		<h1><MMString:loadString id="Commands/CFLoginWizard/text/LDAP_1" /></h1>
		<table border="0" cellpadding="0" cellspacing="2" width="100%" align="center">
			<tr>
				<td colspan="3"> <MMString:loadString id="Commands/CFLoginWizard/text/Enter_1" /> </td>
			</tr>
			<tr>
				<td>&nbsp;</td>
				<td width="150">&nbsp;</td>
				<td>&nbsp;</td>
			</tr>
			<tr valign="baseline">
				<td align="right"><MMString:loadString id="Commands/CFLoginWizard/text/Server" /></td>
				<td width="150"><input name="ldapserver" type="Text"  size="40" class="cls_CFLoginWizard_input_ldapserver" required="yes">
				</td>
				<td><MMString:loadString id="Commands/CFLoginWizard/text/Server_1" /> </td>
			</tr>
			<tr valign="baseline">
				<td align="right"><MMString:loadString id="Commands/CFLoginWizard/text/Port" /></td>
				<td width="150"><input name="ldapport" type="Text"  value="389" size="40" class="cls_CFLoginWizard_input_ldapport">
				</td>
				<td><MMString:loadString id="Commands/CFLoginWizard/text/Server_2" /></td>
			</tr>
			<tr valign="baseline">
				<td align="right"><MMString:loadString id="Commands/CFLoginWizard/text/Start" /></td>
				<td width="150"><input name="ldapstart" type="Text" class="cls_CFLoginWizard_input_ldapstart"   size="50" required="yes">
				</td>
				<td><MMString:loadString id="Commands/CFLoginWizard/text/The" /><code><MMString:loadString id="Commands/CFLoginWizard/text/oairiuscom" /></code>) </td>
			</tr>
			<tr valign="baseline">
				<td align="right"><MMString:loadString id="Commands/CFLoginWizard/text/User" /></td>
				<td width="150"><input name="ldapusername" type="Text"   size="50" class="cls_CFLoginWizard_input_ldapusername" required="yes">
				</td>
				<td><MMString:loadString id="Commands/CFLoginWizard/text/The_1" /><code><MMString:loadString id="Commands/CFLoginWizard/text/cnDirectory" /></code>)</td>
			</tr>
			<tr valign="baseline">
				<td align="right"><MMString:loadString id="Commands/CFLoginWizard/text/Password" /></td>
				<td width="150"><input name="ldappassword" type="password" size="50" class="cls_CFLoginWizard_input_ldappassword" required="yes">
				</td>
				<td>&nbsp;</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
				<td width="150"><input type="submit" name="LDAPauth_verify" MMString:value="Commands/CFLoginWizard/submit/LDAPauth_verify/Verify" onClick="verifyldapserver();">
					<span id="ldapvalidated">&nbsp;</span> </td>
				<td>&nbsp;</td>
			</tr>
		</table>
		<div id="LDAPAuthButtons" class="mainWizardButtons">
			<div class="leftWizardButtons">
				<input type="submit" class="navButtonHelp" name="LDAPauth_help" MMString:value="Commands/CFLoginWizard/submit/appname_help/Help" onclick="dwscripts.displayDWHelp(HELP_DOC);" >
			</div>
			<div class="rightWizardButtons">
				<input type="submit" class="navButtonBack" name="LDAPauth_back" MMString:value="Commands/CFLoginWizard/submit/appname_back/Back" onclick="displayAuthType();">
				<!--- force the user to validate the LDAP against the server before they continue --->
				<input type="submit" class="navButtonNext" name="LDAPauth_next" MMString:value="Commands/CFLoginWizard/submit/appname_next/Next" onclick="ldapauthquerystring();">
				<input type="submit" class="navButtonCancel" name="LDAPauth_cancel" MMString:value="Commands/CFLoginWizard/submit/appname_cancel/Cancel" onclick="window.close();" >
			</div>
		</div>
	</form>
</div>
<div id="LDAPAuthQueryString" class="mainWizardPanel">
	<form name="LDAPquery">
		<img src="BNR_ColdFusionLoginWizard.png" MMString:alt="Commands/CFLoginWizard/img/alt/Macromedia" width="642" height="73">
		<h1><MMString:loadString id="Commands/CFLoginWizard/text/LDAP_2" /></h1>
		<p><MMString:loadString id="Commands/CFLoginWizard/text/For" /></p>
		<p><MMString:loadString id="Commands/CFLoginWizard/text/Query" />
			<input name="querystring" type="text" size="40" class="cls_CFLoginWizard_input_querystring">
		</p>
		<!-- Commenting out retrieve query string button. This will be implemented as part of "B" features -->
		<!--  <input type="submit" name="LDAPquery_retrieve" value="Retrieve Query String From Server" onclick="getLDAPQueryString();"> -->
		<div id="LDAPAuthQueryStringButtons" class="mainWizardButtons">
			<div class="leftWizardButtons">
				<input type="submit" class="navButtonHelp" name="LDAPquery_help" MMString:value="Commands/CFLoginWizard/submit/appname_help/Help" onclick="dwscripts.displayDWHelp(HELP_DOC);" >
			</div>
			<div class="rightWizardButtons">
				<input type="submit" class="navButtonBack" name="LDAPquery_back" MMString:value="Commands/CFLoginWizard/submit/appname_back/Back" onclick="selectAuthType();">
				<input type="submit" class="navButtonNext" name="LDAPquery_next" MMString:value="Commands/CFLoginWizard/submit/appname_next/Next" onclick="callCodeGen('LDAP');">
				<input type="submit" class="navButtonCancel" name="LDAPquery_cancel" MMString:value="Commands/CFLoginWizard/submit/appname_cancel/Cancel" onclick="window.close();" >
			</div>
		</div>
	</form>
</div>
<div id="SimpleAuth" class="mainWizardPanel">
	<form name="SMPLauth">
		<img src="BNR_ColdFusionLoginWizard.png" MMString:alt="Commands/CFLoginWizard/img/alt/Macromedia" width="642" height="73">
		<h1><MMString:loadString id="Commands/CFLoginWizard/text/Simple_1" /></h1>
		<p><MMString:loadString id="Commands/CFLoginWizard/text/Create" /></p>
		<table border="0" width="600" align="center">
			<tr>
				<td align="right" valign="baseline"><MMString:loadString id="Commands/CFLoginWizard/text/User" /></td>
				<td align="left" valign="baseline"><input name="simpleusername" type="Text"  size="40" class="cls_CFLoginWizard_input_simpleusername"></td>
			</tr>
			<tr>
				<td align="right" valign="baseline"><MMString:loadString id="Commands/CFLoginWizard/text/Password" /></td>
				<td align="left" valign="baseline"><input name="simplepassword" type="password" size="40" class="cls_CFLoginWizard_input_simplepassword"></td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
		</table>
		<div id="SimpleAuthButtons" class="mainWizardButtons">
			<div class="leftWizardButtons">
				<input type="submit" class="navButtonHelp" name="SMPLauth_help" MMString:value="Commands/CFLoginWizard/submit/appname_help/Help" onclick="dwscripts.displayDWHelp(HELP_DOC);" >
			</div>
			<div class="rightWizardButtons">
				<input type="submit" class="navButtonBack" name="SMPLauth_back" MMString:value="Commands/CFLoginWizard/submit/appname_back/Back" onclick="displayAuthType();">
				<input type="submit" class="navButtonNext" name="SMPLauth_next" MMString:value="Commands/CFLoginWizard/submit/appname_next/Next" onclick="callCodeGen('Simple');">
				<input type="submit" class="navButtonCancel" name="SMPLauth_cancel" MMString:value="Commands/CFLoginWizard/submit/appname_cancel/Cancel" onclick="window.close();" >
			</div>
		</div>
	</form>
</div>
<!--this is used when the wizard is being run for the first time-->
<div id="CodeComplete" class="mainWizardPanel">
	<form name="CODEcomplete">
		<img src="BNR_ColdFusionLoginWizard.png" MMString:alt="Commands/CFLoginWizard/img/alt/Macromedia" width="642" height="73">
		<h1><MMString:loadString id="Commands/CFLoginWizard/text/Wizard" /></h1>
		<p><MMString:loadString id="Commands/CFLoginWizard/text/Authentication_1" /></p>
		<ul style="text-indent:-15px;">
			<li><MMString:loadString id="Commands/CFLoginWizard/text/Applicationcfc" /></li>
			<li><MMString:loadString id="Commands/CFLoginWizard/text/mmwizardapplicationincludecfm" /></li>
			<li><MMString:loadString id="Commands/CFLoginWizard/text/mmwizardlogincfm" /></li>
			<li><MMString:loadString id="Commands/CFLoginWizard/text/mmwizardauthenticatecfc" /> </li>
		</ul>
		<!--<input type="checkbox" name="put1" onclick="Put_site();">&nbsp;Put the Login Wizard files onto the remote machine <br><br>-->
		<div id="CodeCompleteButtons" class="mainWizardButtons">
			<div class="rightWizardButtons">
				<input type="submit" class="navButtonNext" name="CODEcomplete_complete" MMString:value="Commands/CFLoginWizard/submit/CODEcomplete_complete/Done" onclick="window.close();">
			</div>
		</div>
	</form>
</div>
<!-- this is used when the wizard has already been run - this is the 2nd time through  -->
<div id="CodeComplete2x" class="mainWizardPanel">
	<form name="CODEcomplete2x">
		<img src="BNR_ColdFusionLoginWizard.png" MMString:alt="Commands/CFLoginWizard/img/alt/Macromedia" width="642" height="73">
		<h1><MMString:loadString id="Commands/CFLoginWizard/text/Wizard" /></h1>
		<p><MMString:loadString id="Commands/CFLoginWizard/text/You" /></p>
		<p><MMString:loadString id="Commands/CFLoginWizard/text/The_2" /> <code><MMString:loadString id="Commands/CFLoginWizard/text/mmwizardapplicationincludecfm" /></code> <MMString:loadString id="Commands/CFLoginWizard/text/and" /> <code><MMString:loadString id="Commands/CFLoginWizard/text/Applicationcfc" /></code> <MMString:loadString id="Commands/CFLoginWizard/text/files" /></p>
		<div id="CodeComplete2xButtons" class="mainWizardButtons">
			<div class="rightWizardButtons">
				<input type="submit" class="navButtonNext" name="CODEcomplete_complete" MMString:value="Commands/CFLoginWizard/submit/CODEcomplete_complete/Done" onclick="window.close();">
			</div>
		</div>
	</form>
</div>
</body>
</html>
